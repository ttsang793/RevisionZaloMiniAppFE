import r from'./../../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import e from'./../../../../external/@swc/helpers/src/_object_spread.mjs.js';import t from"../../../token.js";import s from"../../../../utils/query-string.js";import{apiResponse as a}from"../../../../utils/response.js";import{PAYMENT_APIS as o}from"../../../../constants.js";import n from"../getRouteParams.js";import{__generator as m}from'./../../../../external/tslib/tslib.es6.js';var i,d=(i=r((function(r){var i,d,p,c,u,g,j,f,l,h,b,y;return m(this,(function(m){switch(m.label){case 0:return r||(r=n()),"object"==typeof r&&((p=r.zmpOrderId||r.orderId)||(d=r.appTransID||r.apptransid||r.transId)),"string"==typeof r&&(c=s.getParameterByName("orderId",r),u=s.getParameterByName("appTransID",r)||s.getParameterByName("apptransid",r),d=c||u),g={headers:{authorization:"Bearer "}},[4,t.jumpAndGetToken()];case 1:return m.sent(),j=null===(i=t.miniProgramConfig)||void 0===i?void 0:i.jwt,g.headers.authorization="Bearer ".concat(j),f=new URL(o.GET_TRANSACTION),l={orderId:p||"",transId:d||""},f.search=new URLSearchParams(l).toString(),[4,fetch(f.toString(),g)];case 2:return[4,m.sent().json()];case 3:if(!(h=m.sent()).data)throw a.error.badRequest(h.msg);return b=h.data||{},y={err:h.err,msg:h.msg},0!==Object.keys(b).length&&b.constructor===Object&&Object.assign(y,e({msg:b.resultMessage},b)),[2,y]}}))})),function(r){return i.apply(this,arguments)});export{d as default};
