import r from'./../../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import e from'./../../../../external/@swc/helpers/src/_object_spread.mjs.js';import t from"../../../token.js";import s from"../../../../utils/query-string.js";import{apiResponse as a}from"../../../../utils/response.js";import{PAYMENT_APIS as o,APP_ID as n}from"../../../../constants.js";import m from"../getRouteParams.js";import{__generator as i}from'./../../../../external/tslib/tslib.es6.js';var c,p=(c=r((function(r){var c,p,d,u,g,f,h,j,l,I,b;return i(this,(function(i){switch(i.label){case 0:return r||(r=m()),"object"==typeof r&&((p=r.zmpOrderId||r.orderId)||(c=r.appTransID||r.apptransid||r.transId)),"string"==typeof r&&(d=s.getParameterByName("orderId",r),u=s.getParameterByName("appTransID",r)||s.getParameterByName("apptransid",r),c=d||u),g={headers:{authorization:"Bearer "}},[4,t.getAccessToken().catch((function(){throw a.error.loginRequired}))];case 1:return f=i.sent(),g.headers.authorization="Bearer ".concat(f),h=new URL(o.GET_TRANSACTION),j={orderId:p||"",transId:c||"",appId:n},h.search=new URLSearchParams(j).toString(),[4,fetch(h.toString(),g)];case 2:return[4,i.sent().json()];case 3:if(!(l=i.sent()).data)throw a.error.badRequest(l.msg);return I=l.data||{},b={err:l.err,msg:l.msg},0!==Object.keys(I).length&&I.constructor===Object&&Object.assign(b,e({msg:I.resultMessage},I)),[2,b]}}))})),function(r){return c.apply(this,arguments)});export{p as default};
