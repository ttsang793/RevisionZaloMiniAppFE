import e from'./../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import r from'./../../../external/@swc/helpers/src/_object_spread.mjs.js';import s from'./../../../external/@swc/helpers/src/_object_spread_props.mjs.js';import{apiResponse as a}from"../../../utils/response.js";import{mpPath as n,MINI_APP_LINK as o,APIS as t}from"../../../constants.js";import{__generator as c}from'./../../../external/tslib/tslib.es6.js';var d,i=(d=e((function(e,d,i,p,h,l){var m,u,w,_,f,P,j,v;return c(this,(function(c){switch(c.label){case 0:return w=new URL(location.href),_=new URLSearchParams,f="".concat(w.pathname.replace(n,"")).concat(w.search),l&&(f="/".concat(e).concat("/"===l[0]?"":"/").concat(l)),!(P=new URL("".concat(o).concat(f))).searchParams.has("env")&&(null===(m=window.APP_ENV)||void 0===m?void 0:m.length)>0&&P.searchParams.set("env",window.APP_ENV),!P.searchParams.has("version")&&(null===(u=window.APP_VERSION)||void 0===u?void 0:u.length)>0&&P.searchParams.set("version",window.APP_VERSION),_.append("title",i),_.append("description",p||""),_.append("thumbnail",h||""),_.append("url",P.href),_.append("accessToken",d||""),j={headers:{"Content-Type":"application/x-www-form-urlencoded"}},[4,fetch(t.CREATE_SHARE_LINK,r({method:"POST",body:_},j))];case 1:return[4,c.sent().json()];case 2:if(!(v=c.sent())||0!==v.err)throw a.error.cannotGetShareInfo();return P.search="".concat(P.search,"&zshareId=").concat(v.data.shareId),[2,s(r({},v.data),{shareableLink:P.href})]}}))})),function(e,r,s,a,n,o){return d.apply(this,arguments)});export{i as default};
