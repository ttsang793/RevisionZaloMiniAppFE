import i from'./../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import t from'./../../../external/@swc/helpers/src/_class_call_check.mjs.js';import o from'./../../../external/@swc/helpers/src/_object_spread.mjs.js';import n from'./../../../external/@swc/helpers/src/_type_of.mjs.js';import e from"../../../utils/lodash.js";import r from"../../call/index.js";import{HIDE_ACTION_BAR as a,SHOW_ACTION_BAR as l,DEFAULT_HEADER_COLOR as s,DEFAULT_TEXT_ALIGN as d,MINI_APP_INTERNAL_LINK as u,APP_ID as f,ACTION_LEFT_BUTTON_TYPE as c}from"../../../constants.js";import{TextAlignType as v,StatusBarType as p,AndroidBottomNavigationBarType as h,IOSSafeAreaBottomType as m}from"../../../types/enum.js";import{getStatusbarType as g,convertStatusBarTypeToNumber as A}from"../../../utils/common.js";import{__generator as C}from'./../../../external/tslib/tslib.es6.js';import T from"../../../appEnv/getEnv.js";var B=function(){function B(){var i,o,n,r,v,p,h,m,g,C,T,_,y,E,O,w,I,H,S,b,N,x,j,D,R,P,M;t(this,B),this.initConfig=window.APP_CONFIG;var G=e.isString(null===(i=this.initConfig)||void 0===i||null===(o=i.app)||void 0===o?void 0:o.headerColor)&&(null===(n=this.initConfig)||void 0===n||null===(r=n.app)||void 0===r||null===(v=r.headerColor)||void 0===v?void 0:v.length)>0?l:a;this.hideIOSSafeAreaBottom=!!(null===(p=this.initConfig)||void 0===p||null===(h=p.app)||void 0===h?void 0:h.hideIOSSafeAreaBottom),this.hideAndroidBottomNavigationBar=!!(null===(m=this.initConfig)||void 0===m||null===(g=m.app)||void 0===g?void 0:g.hideAndroidBottomNavigationBar);var L,K,U="none"===(null===(C=this.initConfig)||void 0===C||null===(T=C.app)||void 0===T?void 0:T.leftButton)||"home"===(null===(_=this.initConfig)||void 0===_||null===(y=_.app)||void 0===y?void 0:y.leftButton)?c.HIDE_BACK:c.SHOW_BACK,W="home"===(null===(E=this.initConfig)||void 0===E||null===(O=E.app)||void 0===O?void 0:O.leftButton)||"both"===(null===(w=this.initConfig)||void 0===w||null===(I=w.app)||void 0===I?void 0:I.leftButton)?c.SHOW_HOME:c.HIDE_HOME,k=new URL(location.href),F=A(null===(H=this.initConfig)||void 0===H||null===(S=H.app)||void 0===S?void 0:S.statusBar);"boolean"==typeof(null===(b=this.initConfig)||void 0===b||null===(N=b.app)||void 0===N?void 0:N.actionBarHidden)&&(G=(null===(L=this.initConfig)||void 0===L||null===(K=L.app)||void 0===K?void 0:K.actionBarHidden)?a:l);this.config={actionbarType:G,buttonType:U,statusbarType:F,dataConfig:{backgroundColor:(null===(x=this.initConfig)||void 0===x||null===(j=x.app)||void 0===j?void 0:j.headerColor)||s,textColor:(null===(D=this.initConfig)||void 0===D||null===(R=D.app)||void 0===R?void 0:R.textColor)||"",textAlign:(null===(P=this.initConfig)||void 0===P||null===(M=P.app)||void 0===M?void 0:M.textAlign)||d,viewInLeftType:U,confirmToExit:1},homeConfig:{enable:W,url:"".concat(u,"/").concat(f,"/").concat(k.search)}}}var _=B.prototype;return _.setNavigationBarTitle=function(t){return i((function(){return C(this,(function(i){return[2,new Promise((function(i,o){r("CHANGE_TITLE_HEADER",{title:t},{success:function(){i(),document.title=t},fail:function(i){o(i)}},{timeout:!1})}))]}))}))()},_.setNavigationBarLeftButton=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.dataConfig.confirmToExit,a=this;return i((function(){var i,l;return C(this,(function(s){return void 0===(void 0===t?"undefined":n(t))&&null===(void 0===t?"undefined":n(t))||(i="none"===t||"home"===t?c.HIDE_BACK:c.SHOW_BACK,l="home"===t||"both"===t?c.SHOW_HOME:c.HIDE_HOME,a.config.buttonType=i,a.config.dataConfig.viewInLeftType=i,a.config.homeConfig.enable=l),a.config.dataConfig.confirmToExit=e,[2,new Promise((function(i,t){r("CHANGE_ACTIONBAR_LEFTBUTTON_TYPE",o({},a.config),{success:function(){i()},fail:function(i){t(i)}},{timeout:!1})}))]}))}))()},_.setAndroidBottomNavigationBar=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this;return i((function(){var i,n,e;return C(this,(function(a){return n=t?h.hide:h.show,e=null===(i=T())||void 0===i?void 0:i.platform,[2,new Promise((function(i,a){if(!(null==e?void 0:e.isAndroid))return i();r("CHANGE_BOTTOMBAR",{bottombarType:n},{success:function(){o.hideAndroidBottomNavigationBar=!!t,window.ANDROID_BOTTOM_NAVIGATION_BAR_HIDDEN=!!t,i()},fail:function(i){a(i)}},{timeout:!1})}))]}))}))()},_.setIOSBottomSafeArea=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this;return i((function(){var i,n,e;return C(this,(function(a){return n=t?m.hide:m.show,e=null===(i=T())||void 0===i?void 0:i.platform,[2,new Promise((function(i,a){if(!(null==e?void 0:e.isIOS))return i();r("CHANGE_BOTTOMBAR",{bottombarType:n},{success:function(){o.hideIOSSafeAreaBottom=!!t,window.IOS_BOTTOM_SAFE_AREA_HIDDEN=!!t,i()},fail:function(i){a(i)}},{timeout:!1,delay:200})}))]}))}))()},_.configHeader=function(t){var n=this;return i((function(){var i;return C(this,(function(s){return i=n.config,e.isString(t.headerColor)&&(i.dataConfig.backgroundColor=t.headerColor),e.isString(t.headerTextColor)&&(i.dataConfig.textColor=t.headerTextColor),e.isString(t.textAlign)&&("left"===t.textAlign?i.dataConfig.textAlign=v.left:"center"===t.textAlign&&(i.dataConfig.textAlign=v.center)),!0===t.hideActionBar?i.actionbarType=a:!1===t.hideActionBar&&(i.actionbarType=l),"normal"===t.statusBarType?i.statusbarType=p.normal:"hidden"===t.statusBarType?i.statusbarType=p.hidden:"transparent"===t.statusBarType&&(i.statusbarType=p.transparent),[2,new Promise((function(e,l){r("CHANGE_ACTIONBAR",o({},i),{success:function(){var r;n.config=o({},i);var l=null===(r=T())||void 0===r?void 0:r.platform;window.STATUS_BAR_TYPE=g(n.config.statusbarType),window.ACTION_BAR_HIDDEN=n.config.actionbarType===a;var s=null===document||void 0===document?void 0:document.querySelector(":root");if(null==l?void 0:l.isAndroid){var d=0;if(("hidden"===t.statusBarType||"transparent"===t.statusBarType)&&t.hideActionBar){var u=window.ANDROID_STATUS_BAR_HEIGHT;isNaN(u)&&(u=Math.round(ZaloJavaScriptInterface.getStatusBarHeight()/window.devicePixelRatio)),d=u}d?null==s||s.style.setProperty("--zaui-safe-area-inset-top","".concat(d,"px")):null==s||s.style.setProperty("--zaui-safe-area-inset-top","env(safe-area-inset-top, 0px)")}e()},fail:function(i){l(i)}},{timeout:!1})}))]}))}))()},B.getInstance=function(){return B.instance||(B.instance=new B),B.instance},B}().getInstance();export{B as default};
