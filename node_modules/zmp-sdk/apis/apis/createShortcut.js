import o from'./../external/@swc/helpers/src/_async_to_generator.mjs.js';import t,{object as r,string as e}from'./../external/zod/lib/index.mjs.js';import n from"../appEnv/index.js";import s from"../common/notFound.js";import{getMetaValue as a}from"../utils/common.js";import{functionHandler as m}from"../utils/decorator.js";import{apiResponse as p}from"../utils/response.js";import{MINI_APP_LINK as i,APP_ID as c}from"../constants.js";import u from"../common/apis/general/createAndroidShortcut.js";import l from"../common/apis/general/getAppInfo.js";import d from"../common/apis/general/openOutApp.js";import{__generator as f}from'./../external/tslib/tslib.es6.js';import j from"../appEnv/getEnv.js";var h=[r({params:t.record(e(),e()).optional()}).optional()];function g(o){return v.apply(this,arguments)}function v(){return v=o((function(t){return f(this,(function(r){return[2,m("createShortcut",h,[t],(e=o((function(o){var t,r,e,m,h,g,v,_;return f(this,(function(f){switch(f.label){case 0:return n.isMp?[4,l(c,0)]:[3,6];case 1:return e=f.sent(),m=null===(t=j())||void 0===t||null===(r=t.platform)||void 0===r?void 0:r.isIOS,h=e.logoUrl||a("og:image:url")||"",g=e.name||document.title,(v=(null==o?void 0:o.params)?new URLSearchParams(null==o?void 0:o.params):new URLSearchParams).append("utm_source","zalo-shortcut"),v.append("utm_medium","default"),v.append("utm_campaign","default"),m?(v.append("appId",c),v.append("appName",g),v.append("appIcon",h),_="https://mini.zalo.me/shortcut.html?".concat(v.toString()),[4,d(encodeURI(_))]):[3,3];case 2:return f.sent(),[3,5];case 3:return[4,u("".concat(i,"/").concat(c,"/?").concat(v.toString()),g,h)];case 4:f.sent(),f.label=5;case 5:return[2,p.success()];case 6:return n.isMpWeb?[2,Promise.resolve()]:[2,Promise.reject(s("createShortcut",{}))]}}))})),function(o){return e.apply(this,arguments)}))];var e}))})),v.apply(this,arguments)}export{g as createShortcut};
